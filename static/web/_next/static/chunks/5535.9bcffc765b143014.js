(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5535],{54907:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return collapse}});var esm_extends=__webpack_require__(87462),defineProperty=__webpack_require__(4942),RightOutlined=__webpack_require__(18073),classnames=__webpack_require__(94184),classnames_default=__webpack_require__.n(classnames),toConsumableArray=__webpack_require__(74902),classCallCheck=__webpack_require__(15671),createClass=__webpack_require__(43144),inherits=__webpack_require__(60136),createSuper=__webpack_require__(33643),esm_typeof=__webpack_require__(71002),toArray=__webpack_require__(50344),react=__webpack_require__(67294),shallowequal=__webpack_require__(96774),shallowequal_default=__webpack_require__.n(shallowequal),objectWithoutProperties=__webpack_require__(45987),es=__webpack_require__(62874),slicedToArray=__webpack_require__(97685),PanelContent=react.forwardRef(function(props,ref){var _classnames,prefixCls=props.prefixCls,forceRender=props.forceRender,className=props.className,style=props.style,children=props.children,isActive=props.isActive,role=props.role,_React$useState=react.useState(isActive||forceRender),_React$useState2=(0,slicedToArray.Z)(_React$useState,2),rendered=_React$useState2[0],setRendered=_React$useState2[1];return(react.useEffect(function(){(forceRender||isActive)&&setRendered(!0)},[forceRender,isActive]),rendered)?react.createElement("div",{ref:ref,className:classnames_default()("".concat(prefixCls,"-content"),(_classnames={},(0,defineProperty.Z)(_classnames,"".concat(prefixCls,"-content-active"),isActive),(0,defineProperty.Z)(_classnames,"".concat(prefixCls,"-content-inactive"),!isActive),_classnames),className),style:style,role:role},react.createElement("div",{className:"".concat(prefixCls,"-content-box")},children)):null});PanelContent.displayName="PanelContent";var _excluded=["className","id","style","prefixCls","headerClass","children","isActive","destroyInactivePanel","accordion","forceRender","openMotion","extra","collapsible"],CollapsePanel=function(_React$Component){(0,inherits.Z)(CollapsePanel,_React$Component);var _super=(0,createSuper.Z)(CollapsePanel);function CollapsePanel(){var _this;(0,classCallCheck.Z)(this,CollapsePanel);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=_super.call.apply(_super,[this].concat(args))).onItemClick=function(){var _this$props=_this.props,onItemClick=_this$props.onItemClick,panelKey=_this$props.panelKey;"function"==typeof onItemClick&&onItemClick(panelKey)},_this.handleKeyPress=function(e){("Enter"===e.key||13===e.keyCode||13===e.which)&&_this.onItemClick()},_this.renderIcon=function(){var _this$props2=_this.props,showArrow=_this$props2.showArrow,expandIcon=_this$props2.expandIcon,prefixCls=_this$props2.prefixCls,collapsible=_this$props2.collapsible;if(!showArrow)return null;var iconNode="function"==typeof expandIcon?expandIcon(_this.props):react.createElement("i",{className:"arrow"});return iconNode&&react.createElement("div",{className:"".concat(prefixCls,"-expand-icon"),onClick:"header"===collapsible||"icon"===collapsible?_this.onItemClick:null},iconNode)},_this.renderTitle=function(){var _this$props3=_this.props,header=_this$props3.header,prefixCls=_this$props3.prefixCls,collapsible=_this$props3.collapsible;return react.createElement("span",{className:"".concat(prefixCls,"-header-text"),onClick:"header"===collapsible?_this.onItemClick:null},header)},_this}return(0,createClass.Z)(CollapsePanel,[{key:"shouldComponentUpdate",value:function(nextProps){return!shallowequal_default()(this.props,nextProps)}},{key:"render",value:function(){var _classNames,_classNames2,_this$props4=this.props,className=_this$props4.className,id=_this$props4.id,style=_this$props4.style,prefixCls=_this$props4.prefixCls,headerClass=_this$props4.headerClass,children=_this$props4.children,isActive=_this$props4.isActive,destroyInactivePanel=_this$props4.destroyInactivePanel,accordion=_this$props4.accordion,forceRender=_this$props4.forceRender,openMotion=_this$props4.openMotion,extra=_this$props4.extra,collapsible=_this$props4.collapsible,rest=(0,objectWithoutProperties.Z)(_this$props4,_excluded),disabled="disabled"===collapsible,collapsibleHeader="header"===collapsible,collapsibleIcon="icon"===collapsible,itemCls=classnames_default()((_classNames={},(0,defineProperty.Z)(_classNames,"".concat(prefixCls,"-item"),!0),(0,defineProperty.Z)(_classNames,"".concat(prefixCls,"-item-active"),isActive),(0,defineProperty.Z)(_classNames,"".concat(prefixCls,"-item-disabled"),disabled),_classNames),className),headerProps={className:classnames_default()("".concat(prefixCls,"-header"),(_classNames2={},(0,defineProperty.Z)(_classNames2,headerClass,headerClass),(0,defineProperty.Z)(_classNames2,"".concat(prefixCls,"-header-collapsible-only"),collapsibleHeader),(0,defineProperty.Z)(_classNames2,"".concat(prefixCls,"-icon-collapsible-only"),collapsibleIcon),_classNames2)),"aria-expanded":isActive,"aria-disabled":disabled,onKeyPress:this.handleKeyPress};return collapsibleHeader||collapsibleIcon||(headerProps.onClick=this.onItemClick,headerProps.role=accordion?"tab":"button",headerProps.tabIndex=disabled?-1:0),delete rest.header,delete rest.panelKey,delete rest.onItemClick,delete rest.showArrow,delete rest.expandIcon,react.createElement("div",(0,esm_extends.Z)({},rest,{className:itemCls,style:style,id:id}),react.createElement("div",headerProps,this.renderIcon(),this.renderTitle(),null!=extra&&"boolean"!=typeof extra&&react.createElement("div",{className:"".concat(prefixCls,"-extra")},extra)),react.createElement(es.Z,(0,esm_extends.Z)({visible:isActive,leavedClassName:"".concat(prefixCls,"-content-hidden")},openMotion,{forceRender:forceRender,removeOnLeave:destroyInactivePanel}),function(_ref,ref){var motionClassName=_ref.className,motionStyle=_ref.style;return react.createElement(PanelContent,{ref:ref,prefixCls:prefixCls,className:motionClassName,style:motionStyle,isActive:isActive,forceRender:forceRender,role:accordion?"tabpanel":null},children)}))}}]),CollapsePanel}(react.Component);function getActiveKeysArray(activeKey){var currentActiveKey=activeKey;if(!Array.isArray(currentActiveKey)){var activeKeyType=(0,esm_typeof.Z)(currentActiveKey);currentActiveKey="number"===activeKeyType||"string"===activeKeyType?[currentActiveKey]:[]}return currentActiveKey.map(function(key){return String(key)})}CollapsePanel.defaultProps={showArrow:!0,isActive:!1,onItemClick:function(){},headerClass:"",forceRender:!1};var Collapse=function(_React$Component){(0,inherits.Z)(Collapse,_React$Component);var _super=(0,createSuper.Z)(Collapse);function Collapse(_props){(0,classCallCheck.Z)(this,Collapse),(_this=_super.call(this,_props)).onClickItem=function(key){var activeKey=_this.state.activeKey;if(_this.props.accordion)activeKey=activeKey[0]===key?[]:[key];else{var index=(activeKey=(0,toConsumableArray.Z)(activeKey)).indexOf(key);index>-1?activeKey.splice(index,1):activeKey.push(key)}_this.setActiveKey(activeKey)},_this.getNewChild=function(child,index){if(!child)return null;var activeKey=_this.state.activeKey,_this$props=_this.props,prefixCls=_this$props.prefixCls,openMotion=_this$props.openMotion,accordion=_this$props.accordion,rootDestroyInactivePanel=_this$props.destroyInactivePanel,expandIcon=_this$props.expandIcon,collapsible=_this$props.collapsible,key=child.key||String(index),_child$props=child.props,header=_child$props.header,headerClass=_child$props.headerClass,destroyInactivePanel=_child$props.destroyInactivePanel,childCollapsible=_child$props.collapsible,isActive=!1;isActive=accordion?activeKey[0]===key:activeKey.indexOf(key)>-1;var mergeCollapsible=null!=childCollapsible?childCollapsible:collapsible,props={key:key,panelKey:key,header:header,headerClass:headerClass,isActive:isActive,prefixCls:prefixCls,destroyInactivePanel:null!=destroyInactivePanel?destroyInactivePanel:rootDestroyInactivePanel,openMotion:openMotion,accordion:accordion,children:child.props.children,onItemClick:"disabled"===mergeCollapsible?null:_this.onClickItem,expandIcon:expandIcon,collapsible:mergeCollapsible};return"string"==typeof child.type?child:(Object.keys(props).forEach(function(propName){void 0===props[propName]&&delete props[propName]}),react.cloneElement(child,props))},_this.getItems=function(){var children=_this.props.children;return(0,toArray.Z)(children).map(_this.getNewChild)},_this.setActiveKey=function(activeKey){"activeKey"in _this.props||_this.setState({activeKey:activeKey}),_this.props.onChange(_this.props.accordion?activeKey[0]:activeKey)};var _this,_activeKey=_props.activeKey,currentActiveKey=_props.defaultActiveKey;return"activeKey"in _props&&(currentActiveKey=_activeKey),_this.state={activeKey:getActiveKeysArray(currentActiveKey)},_this}return(0,createClass.Z)(Collapse,[{key:"shouldComponentUpdate",value:function(nextProps,nextState){return!shallowequal_default()(this.props,nextProps)||!shallowequal_default()(this.state,nextState)}},{key:"render",value:function(){var _classNames,_this$props2=this.props,prefixCls=_this$props2.prefixCls,className=_this$props2.className,style=_this$props2.style,accordion=_this$props2.accordion,collapseClassName=classnames_default()((_classNames={},(0,defineProperty.Z)(_classNames,prefixCls,!0),(0,defineProperty.Z)(_classNames,className,!!className),_classNames));return react.createElement("div",{className:collapseClassName,style:style,role:accordion?"tablist":null},this.getItems())}}],[{key:"getDerivedStateFromProps",value:function(nextProps){var newState={};return"activeKey"in nextProps&&(newState.activeKey=getActiveKeysArray(nextProps.activeKey)),newState}}]),Collapse}(react.Component);Collapse.defaultProps={prefixCls:"rc-collapse",onChange:function(){},accordion:!1,destroyInactivePanel:!1},Collapse.Panel=CollapsePanel,Collapse.Panel;var omit=__webpack_require__(98423),context=__webpack_require__(53124),motion=__webpack_require__(33603),reactNode=__webpack_require__(96159),Collapse_Collapse=function(props){var children,_classNames,_React$useContext=react.useContext(context.E_),getPrefixCls=_React$useContext.getPrefixCls,direction=_React$useContext.direction,customizePrefixCls=props.prefixCls,_props$className=props.className,_props$bordered=props.bordered,ghost=props.ghost,_props$expandIconPosi=props.expandIconPosition,expandIconPosition=void 0===_props$expandIconPosi?"start":_props$expandIconPosi,prefixCls=getPrefixCls("collapse",customizePrefixCls),mergedExpandIconPosition=react.useMemo(function(){return"left"===expandIconPosition?"start":"right"===expandIconPosition?"end":expandIconPosition},[expandIconPosition]),collapseClassName=classnames_default()("".concat(prefixCls,"-icon-position-").concat(mergedExpandIconPosition),(_classNames={},(0,defineProperty.Z)(_classNames,"".concat(prefixCls,"-borderless"),!(void 0===_props$bordered||_props$bordered)),(0,defineProperty.Z)(_classNames,"".concat(prefixCls,"-rtl"),"rtl"===direction),(0,defineProperty.Z)(_classNames,"".concat(prefixCls,"-ghost"),!!ghost),_classNames),void 0===_props$className?"":_props$className),openMotion=(0,esm_extends.Z)((0,esm_extends.Z)({},motion.ZP),{motionAppear:!1,leavedClassName:"".concat(prefixCls,"-content-hidden")});return react.createElement(Collapse,(0,esm_extends.Z)({openMotion:openMotion},props,{expandIcon:function(){var panelProps=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},expandIcon=props.expandIcon,icon=expandIcon?expandIcon(panelProps):react.createElement(RightOutlined.Z,{rotate:panelProps.isActive?90:void 0});return(0,reactNode.Tm)(icon,function(){return{className:classnames_default()(icon.props.className,"".concat(prefixCls,"-arrow"))}})},prefixCls:prefixCls,className:collapseClassName}),(children=props.children,(0,toArray.Z)(children).map(function(child,index){var _a;if(null===(_a=child.props)||void 0===_a?void 0:_a.disabled){var key=child.key||String(index),_child$props=child.props,disabled=_child$props.disabled,collapsible=_child$props.collapsible,childProps=(0,esm_extends.Z)((0,esm_extends.Z)({},(0,omit.Z)(child.props,["disabled"])),{key:key,collapsible:null!=collapsible?collapsible:disabled?"disabled":void 0});return(0,reactNode.Tm)(child,childProps)}return child})))};Collapse_Collapse.Panel=function(props){var getPrefixCls=react.useContext(context.E_).getPrefixCls,customizePrefixCls=props.prefixCls,_props$className=props.className,_props$showArrow=props.showArrow,prefixCls=getPrefixCls("collapse",customizePrefixCls),collapsePanelClassName=classnames_default()((0,defineProperty.Z)({},"".concat(prefixCls,"-no-arrow"),!(void 0===_props$showArrow||_props$showArrow)),void 0===_props$className?"":_props$className);return react.createElement(Collapse.Panel,(0,esm_extends.Z)({},props,{prefixCls:prefixCls,className:collapsePanelClassName}))};var collapse=Collapse_Collapse},11382:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(87462),_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(4942),_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(97685),classnames__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(94184),classnames__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_0__),lodash_debounce__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(23279),lodash_debounce__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_debounce__WEBPACK_IMPORTED_MODULE_1__),rc_util_es_omit__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(98423),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(67294),_config_provider__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(53124),_util_reactNode__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(96159),_util_type__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(93355),__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&0>e.indexOf(p)&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)0>e.indexOf(p[i])&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]]);return t};(0,_util_type__WEBPACK_IMPORTED_MODULE_3__.b)("small","default","large");var defaultIndicator=null,Spin=function(props){var prefixCls=props.spinPrefixCls,_props$spinning=props.spinning,customSpinning=void 0===_props$spinning||_props$spinning,delay=props.delay,className=props.className,_props$size=props.size,size=void 0===_props$size?"default":_props$size,tip=props.tip,wrapperClassName=props.wrapperClassName,style=props.style,children=props.children,restProps=__rest(props,["spinPrefixCls","spinning","delay","className","size","tip","wrapperClassName","style","children"]),_React$useState=react__WEBPACK_IMPORTED_MODULE_2__.useState(function(){return customSpinning&&(!customSpinning||!delay||!!isNaN(Number(delay)))}),_React$useState2=(0,_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_5__.Z)(_React$useState,2),spinning=_React$useState2[0],setSpinning=_React$useState2[1];return react__WEBPACK_IMPORTED_MODULE_2__.useEffect(function(){var updateSpinning=lodash_debounce__WEBPACK_IMPORTED_MODULE_1___default()(function(){setSpinning(customSpinning)},delay);return updateSpinning(),function(){var _a;null===(_a=null==updateSpinning?void 0:updateSpinning.cancel)||void 0===_a||_a.call(updateSpinning)}},[delay,customSpinning]),react__WEBPACK_IMPORTED_MODULE_2__.createElement(_config_provider__WEBPACK_IMPORTED_MODULE_9__.C,null,function(_ref){var indicator,dotClassName,_classNames,direction=_ref.direction,spinClassName=classnames__WEBPACK_IMPORTED_MODULE_0___default()(prefixCls,(_classNames={},(0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.Z)(_classNames,"".concat(prefixCls,"-sm"),"small"===size),(0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.Z)(_classNames,"".concat(prefixCls,"-lg"),"large"===size),(0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.Z)(_classNames,"".concat(prefixCls,"-spinning"),spinning),(0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.Z)(_classNames,"".concat(prefixCls,"-show-text"),!!tip),(0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.Z)(_classNames,"".concat(prefixCls,"-rtl"),"rtl"===direction),_classNames),className),divProps=(0,rc_util_es_omit__WEBPACK_IMPORTED_MODULE_7__.Z)(restProps,["indicator","prefixCls"]),spinElement=react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.Z)({},divProps,{style:style,className:spinClassName,"aria-live":"polite","aria-busy":spinning}),(indicator=props.indicator,dotClassName="".concat(prefixCls,"-dot"),null===indicator?null:(0,_util_reactNode__WEBPACK_IMPORTED_MODULE_4__.l$)(indicator)?(0,_util_reactNode__WEBPACK_IMPORTED_MODULE_4__.Tm)(indicator,{className:classnames__WEBPACK_IMPORTED_MODULE_0___default()(indicator.props.className,dotClassName)}):(0,_util_reactNode__WEBPACK_IMPORTED_MODULE_4__.l$)(defaultIndicator)?(0,_util_reactNode__WEBPACK_IMPORTED_MODULE_4__.Tm)(defaultIndicator,{className:classnames__WEBPACK_IMPORTED_MODULE_0___default()(defaultIndicator.props.className,dotClassName)}):react__WEBPACK_IMPORTED_MODULE_2__.createElement("span",{className:classnames__WEBPACK_IMPORTED_MODULE_0___default()(dotClassName,"".concat(prefixCls,"-dot-spin"))},react__WEBPACK_IMPORTED_MODULE_2__.createElement("i",{className:"".concat(prefixCls,"-dot-item")}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("i",{className:"".concat(prefixCls,"-dot-item")}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("i",{className:"".concat(prefixCls,"-dot-item")}),react__WEBPACK_IMPORTED_MODULE_2__.createElement("i",{className:"".concat(prefixCls,"-dot-item")}))),tip?react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:"".concat(prefixCls,"-text")},tip):null);if(void 0!==children){var containerClassName=classnames__WEBPACK_IMPORTED_MODULE_0___default()("".concat(prefixCls,"-container"),(0,_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_6__.Z)({},"".concat(prefixCls,"-blur"),spinning));return react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.Z)({},divProps,{className:classnames__WEBPACK_IMPORTED_MODULE_0___default()("".concat(prefixCls,"-nested-loading"),wrapperClassName)}),spinning&&react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{key:"loading"},spinElement),react__WEBPACK_IMPORTED_MODULE_2__.createElement("div",{className:containerClassName,key:"container"},children))}return spinElement})},SpinFC=function(props){var customizePrefixCls=props.prefixCls,spinPrefixCls=(0,react__WEBPACK_IMPORTED_MODULE_2__.useContext(_config_provider__WEBPACK_IMPORTED_MODULE_9__.E_).getPrefixCls)("spin",customizePrefixCls),spinClassProps=(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.Z)((0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.Z)({},props),{spinPrefixCls:spinPrefixCls});return react__WEBPACK_IMPORTED_MODULE_2__.createElement(Spin,(0,_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_8__.Z)({},spinClassProps))};SpinFC.setDefaultIndicator=function(indicator){defaultIndicator=indicator},__webpack_exports__.Z=SpinFC},65535:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{AuthModal:function(){return AuthModal}});var jsx_runtime=__webpack_require__(85893),tabs=__webpack_require__(84381),es=__webpack_require__(4480),collapse=__webpack_require__(54907),typography=__webpack_require__(84485),spin=__webpack_require__(11382),space=__webpack_require__(26713),es_alert=__webpack_require__(14670),input=__webpack_require__(69677),react=__webpack_require__(67294),urls=__webpack_require__(37174);let{Panel}=collapse.Z,{Link}=typography.Z,IndieAuthModal=param=>{let{authenticated,displayName:username,accessToken}=param,[errorMessage,setErrorMessage]=(0,react.useState)(null),[loading,setLoading]=(0,react.useState)(!1),[valid,setValid]=(0,react.useState)(!1),[host,setHost]=(0,react.useState)(""),message=authenticated?(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("b",{children:"You are already authenticated"}),". However, you can add other domains or log in as a different user."]}):(0,jsx_runtime.jsxs)("span",{children:["Use your own domain to authenticate ",(0,jsx_runtime.jsx)("span",{children:username})," or login as a previously"," ","authenticated chat user using IndieAuth."]}),errorMessageText=errorMessage;errorMessageText&&errorMessageText.includes("url does not support indieauth")&&(errorMessageText="The provided URL is either invalid or does not support IndieAuth.");let validate=url=>{if(!(0,urls.Z)(url)||!url.includes(".")){setValid(!1);return}setValid(!0)},onInput=e=>{let char=e.nativeEvent.data;if(":"===char)return;setHost(e.target.value);let h="https://".concat(e.target.value);validate(h)},submitButtonPressed=async()=>{if(valid){setLoading(!0);try{let rawResponse=await fetch("/api/auth/indieauth?accessToken=".concat(accessToken),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({authHost:"https://".concat(host)})}),content=await rawResponse.json();if(content.message){setErrorMessage(content.message),setLoading(!1);return}if(!content.redirect){setErrorMessage("Auth provider did not return a redirect URL."),setLoading(!1);return}if(content.redirect){let{redirect}=content;window.location=redirect}}catch(e){setErrorMessage(e.message)}setLoading(!1)}};return(0,jsx_runtime.jsx)(spin.Z,{spinning:loading,children:(0,jsx_runtime.jsxs)(space.Z,{direction:"vertical",children:[message,errorMessageText&&(0,jsx_runtime.jsx)(es_alert.Z,{message:"Error",description:errorMessageText,type:"error",showIcon:!0}),(0,jsx_runtime.jsx)("div",{children:"Your domain"}),(0,jsx_runtime.jsx)(input.Z.Search,{addonBefore:"https://",onInput:onInput,type:"url",value:host,placeholder:"yoursite.com",status:!valid&&host.length>0?"error":void 0,onSearch:submitButtonPressed}),(0,jsx_runtime.jsx)(collapse.Z,{ghost:!0,children:(0,jsx_runtime.jsxs)(Panel,{header:"Learn more about using IndieAuth to authenticate with chat.",children:[(0,jsx_runtime.jsx)("p",{children:"IndieAuth allows for a completely independent and decentralized way of identifying yourself using your own domain."}),(0,jsx_runtime.jsxs)("p",{children:["If you run an Owncast instance, you can use that domain here. Otherwise,"," ",(0,jsx_runtime.jsx)(Link,{href:"https://indieauth.net/#providers",children:"learn more about how you can support IndieAuth"}),"."]})]},"header")}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Note"}),": This is for authentication purposes only, and no personal information will be accessed or stored."]})]})})};var es_button=__webpack_require__(71577),FediAuthModal_module=__webpack_require__(50501),FediAuthModal_module_default=__webpack_require__.n(FediAuthModal_module);let{Panel:FediAuthModal_Panel}=collapse.Z,FediAuthModal=param=>{let{authenticated,displayName,accessToken}=param,[errorMessage,setErrorMessage]=(0,react.useState)(null),[loading,setLoading]=(0,react.useState)(!1),[valid,setValid]=(0,react.useState)(!1),[account,setAccount]=(0,react.useState)(""),[code,setCode]=(0,react.useState)(""),[verifyingCode,setVerifyingCode]=(0,react.useState)(!1),message=authenticated?(0,jsx_runtime.jsxs)("span",{children:[(0,jsx_runtime.jsx)("b",{children:"You are already authenticated"}),". However, you can add other domains or log in as a different user."]}):(0,jsx_runtime.jsxs)("span",{children:["Receive a direct message on the Fediverse to link your account to"," ",(0,jsx_runtime.jsx)("strong",{children:displayName}),", or login as a previously linked chat user."]}),errorMessageText=errorMessage;errorMessageText&&errorMessageText.includes("url does not support indieauth")&&(errorMessageText="The provided URL is either invalid or does not support IndieAuth.");let validate=acct=>{setValid(function(account){let a=account.replace(/^@+/,"");return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(a).toLowerCase())}(acct))},onInput=e=>{setAccount(e.target.value),validate(e.target.value)},makeRequest=async(url,data)=>{let rawResponse=await fetch(url,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(data)}),content=await rawResponse.json();content.message&&(setErrorMessage(content.message),setLoading(!1))},submitCodePressed=async()=>{setLoading(!0);try{await makeRequest("/api/auth/fediverse/verify?accessToken=".concat(accessToken),{code}),window.location.href="/"}catch(e){console.error(e),setErrorMessage(e)}setLoading(!1)},submitAccountPressed=async()=>{if(!valid)return;setLoading(!0),setErrorMessage(null);let normalizedAccount=account.replace(/^@+/,"");try{await makeRequest("/api/auth/fediverse?accessToken=".concat(accessToken),{account:normalizedAccount}),setVerifyingCode(!0)}catch(e){console.error(e),setErrorMessage(e)}setLoading(!1)},inputCodeStep=(0,jsx_runtime.jsxs)("div",{children:["Paste in the code that was sent to your Fediverse account. If you did not receive a code, make sure you can accept direct messages.",(0,jsx_runtime.jsxs)("div",{className:FediAuthModal_module_default().codeInputContainer,children:[(0,jsx_runtime.jsx)(input.Z,{value:code,onChange:e=>setCode(e.target.value),className:FediAuthModal_module_default().codeInput,placeholder:"123456",maxLength:6}),(0,jsx_runtime.jsx)(es_button.Z,{type:"primary",onClick:submitCodePressed,disabled:code.length<6,className:FediAuthModal_module_default().submitButton,children:"Verify Code"})]})]}),inputAccountStep=(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("div",{children:"Your Fediverse Account"}),(0,jsx_runtime.jsx)(input.Z.Search,{addonBefore:"@",onInput:onInput,value:account,placeholder:"youraccount@yourserver.com",status:!valid&&account.length>0?"error":void 0,onSearch:submitAccountPressed})]});return(0,jsx_runtime.jsx)(spin.Z,{spinning:loading,children:(0,jsx_runtime.jsxs)(space.Z,{direction:"vertical",children:[message,errorMessageText&&(0,jsx_runtime.jsx)(es_alert.Z,{message:"Error",description:errorMessageText,type:"error",showIcon:!0}),verifyingCode?inputCodeStep:inputAccountStep,(0,jsx_runtime.jsx)(collapse.Z,{ghost:!0,children:(0,jsx_runtime.jsx)(FediAuthModal_Panel,{header:"Learn more about using the Fediverse to authenticate with chat.",children:(0,jsx_runtime.jsx)("p",{children:"xxxxxx"})},"header")}),(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("strong",{children:"Note"}),": This is for authentication purposes only, and no personal information will be accessed or stored."]})]})})};var fediverse_black={src:"/_next/static/media/fediverse-black.0b51c805.png",height:100,width:100,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAOVBMVEVMaXEbGxsREREQEBAPDw8NDQ0FBQUQEBAQEBAUFBQNDQ0REREVFRUQEBAODg4UFBQUFBQHBwcNDQ1DUQGwAAAAE3RSTlMAC2QvWeDEnZQbSn15tW2ri/pAr8wTOgAAAAlwSFlzAAALEwAACxMBAJqcGAAAAD1JREFUeJwdy0cOgDAMAMGNS2yHFPj/Z0GcRwMwegNaWbgB3WfmZSArZd7eqR0qEYM6GT/pc/bygqal8v0XMgEBhHcrytIAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},indieauth={src:"/_next/static/media/indieauth.38c52a3d.png",height:512,width:406,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAICAMAAADtGH4KAAAAJFBMVEU4ODg4ODg5OTk5OTk5OTk4ODg5OTk4ODg5OTk5OTk5OTk4ODiRUFfYAAAAC3RSTlMCFOuovTv1zI8wabTrOYwAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAsSURBVHicBcGFAQAwDMCg1Gb5/98BHG1gd2UQGeQwVvl4ujyUEzbbi8nyhn4bVgEfoFU38wAAAABJRU5ErkJggg==",blurWidth:6,blurHeight:8},AuthModal_module=__webpack_require__(54639),AuthModal_module_default=__webpack_require__.n(AuthModal_module),ClientConfigStore=__webpack_require__(77466);let AuthModal=()=>{let authenticated=(0,es.sJ)(ClientConfigStore.L4),accessToken=(0,es.sJ)(ClientConfigStore.FI),currentUser=(0,es.sJ)(ClientConfigStore.db);if(!currentUser)return null;let{displayName}=currentUser,indieAuthTabTitle=(0,jsx_runtime.jsxs)("span",{className:AuthModal_module_default().tabContent,children:[(0,jsx_runtime.jsx)("img",{className:AuthModal_module_default().icon,src:indieauth.src,alt:"IndieAuth"}),"IndieAuth"]}),indieAuthTab=(0,jsx_runtime.jsx)(IndieAuthModal,{authenticated:authenticated,displayName:displayName,accessToken:accessToken}),fediAuthTabTitle=(0,jsx_runtime.jsxs)("span",{className:AuthModal_module_default().tabContent,children:[(0,jsx_runtime.jsx)("img",{className:AuthModal_module_default().icon,src:fediverse_black.src,alt:"Fediverse auth"}),"FediAuth"]}),fediAuthTab=(0,jsx_runtime.jsx)(FediAuthModal,{authenticated:authenticated,displayName:displayName,accessToken:accessToken});return(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(tabs.Z,{defaultActiveKey:"1",items:[{label:indieAuthTabTitle,key:"1",children:indieAuthTab},{label:fediAuthTabTitle,key:"2",children:fediAuthTab}],type:"card",size:"small",renderTabBar:null})})}},54639:function(module){module.exports={tabContent:"AuthModal_tabContent__KgMU3",icon:"AuthModal_icon__kpEuV"}},50501:function(module){module.exports={codeInputContainer:"FediAuthModal_codeInputContainer__M_dAD",codeInput:"FediAuthModal_codeInput__dIE6u",submitButton:"FediAuthModal_submitButton__iuF9R"}}}]);